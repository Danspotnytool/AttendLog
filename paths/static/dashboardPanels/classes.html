<body>
    <style>
        .classCard {
            height: 20rem;
            width: 35rem;
            margin: 1rem;
            border-radius: 1rem;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }
        .description {
            height: 12.5rem;
            width: 100%;
            top: -100%;
            left: 0;
            padding: 2%;
            font-size: 1.5rem;
            position: absolute;
            transition: top 0.25s;
        }
        .classCard:hover .description {
            top: 0;
        }
        .titleCard {
            height: 7.5rem;
            width: 100%;
            padding: 1rem;
            bottom: 0;
            display: flex;
            flex-direction: column;
            position: absolute;
        }
        .titleCard h3 {
            font-size: 2.5rem;
            text-align: left;
        }
        .infoCard {
            height: 100%;
            width: 100%;
            bottom: 0;
            font-size: 1.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        @media screen and (max-width: 650px) {
            .classCard {
                height: 15rem;
                width: 25rem;
            }
            .titleCard h3 {
                font-size: 1.5rem;
            }
            .infoCard {
                font-size: 1.25rem;
            }    
        }
        @media screen and (max-width: 550px) {
            .classCard {
                height: 20rem;
                width: 30rem;
            }
            .titleCard h3 {
                font-size: 1.5rem;
            }
            .infoCard {
                font-size: 1.25rem;
            }    
        }
    </style>

    <div id="classesContainer">

    </div>


    <script type="text/javascript">
        (()=> {
            // Get user's classes
            const getUserClasses = async () => {
                // Errase the classes
                const classesContainer = document.getElementById('classesContainer');
                if (classesContainer.children.length > 0) {
                    while (classesContainer.firstChild) {
                        classesContainer.removeChild(classesContainer.firstChild);
                    };
                };
            
                fetch('/api/classes/get', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(response => response.json())
                .then(data => {
                    if (data.code === '400') {
                        return console.log(data.message);
                    } else {
                        const classes = Array.from(data);
                        const classesContainer = document.getElementById('classesContainer');
                        classes.forEach((classData) => {
                            const classCard = document.createElement('div');
                            classCard.className = 'classCard';
                            classCard.style.backgroundColor = `${classData.classColor}`;
            
                            // Check if the class color is dark or light
                            const color = classData.classColor;
                            let r = parseInt(color.substring(1, 3), 16);
                            let g = parseInt(color.substring(3, 5), 16);
                            let b = parseInt(color.substring(5, 7), 16);
                            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
                            const titleCard = document.createElement('div');
                            if (brightness < 125) {
                                titleCard.style.color = 'white';
                                const newR = Math.round(r * 0.8).toString(16);
                                const newG = Math.round(g * 0.8).toString(16);
                                const newB = Math.round(b * 0.8).toString(16);
                                const newColor = `#${newR}${newG}${newB}`;
                                classCard.style.backgroundColor = `${newColor}`;
                            } else {
                                titleCard.style.color = 'black';
                                const newR = Math.round(r * 1.2).toString(16);
                                const newG = Math.round(g * 1.2).toString(16);
                                const newB = Math.round(b * 1.2).toString(16);
                                const newColor = `#${newR}${newG}${newB}`;
                                classCard.style.backgroundColor = `${newColor}`;
                            };
                            titleCard.className = 'titleCard';
            
                            classCard.appendChild(titleCard);
            
                            const title = document.createElement('h3');
                            title.innerHTML = `${classData.className}`;
                            titleCard.appendChild(title);
            
                            const infoCard = document.createElement('div');
                            infoCard.className = 'infoCard';
                            titleCard.appendChild(infoCard);
            
                            const teacherName = document.createElement('h4');
                            teacherName.innerText = `${classData.teacherName}`;
                            infoCard.appendChild(teacherName);
            
                            const studentsNumber = document.createElement('h4');
                            studentsNumber.innerText = `${classData.numberOfStudents || 0}`;
                            infoCard.appendChild(studentsNumber);
            
                            const description = document.createElement('p');
                            description.className = 'description';
                            description.innerText = `${classData.classDescription}`;
                            if (brightness < 125) {
                                description.style.color = 'white';
                            } else {
                                description.style.color = 'black';
                            };
                            classCard.appendChild(description);
            
            
                            classesContainer.appendChild(classCard);
                        });
                    };
                }).catch((err) => {
                    console.log(err);
                });
            };
            getUserClasses();
        })();
    </script>
</body>